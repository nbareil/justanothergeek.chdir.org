---
categories:
- sandbox
- vulnerability
- seccomp
- kernel
date: "2010-08-25T14:09:00Z"
title: What is really the attack surface of the kernel running a SECCOMP process?
---

<div class='post'>
In a previous post,
<a href="http://justanothergeek.chdir.org/2010/03/seccomp-as-sandboxing-solution.html">I said the attack surface of the kernel for processes running SECCOMP was really low</a>.
To confirm this assumption, each <a href="http://secunia.com/advisories/product/2719/">vulnerability affecting the 2.6 kernel</a> was reviewed.
<br />
<br />
Only those triggerable from a SECCOMPed process were kept. On
440 vulnerabilities, 13 were qualified:
<br />
<br />
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<caption></caption>
<colgroup><col align="left"></col><col align="left"></col><col align="left"></col><col align="left"></col>
</colgroup>
<thead>
<tr><th scope="col">Impact</th><th scope="col">Description</th><th scope="col">Architecture</th><th scope="col">Reference</th></tr>
</thead>
<tbody>
<tr style="font-weight: bold;"><td><span style="color: #ff1a00;">HIGH</span></td><td>infinite loop triggering signal handler</td><td><strong>i386</strong></td><td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0554">CVE-2004-0554</a></td></tr>
<tr><td><span style="color: #ff7400;">MEDIUM</span></td><td><code>audit_syscall_entry</code> bypass</td><td>amd64</td><td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0834">CVE-2009-0834</a></td></tr>
<tr><td><span style="color: #ff7400;">MEDIUM</span></td><td><code>SECCOMP</code> bypass</td><td>amd64</td><td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0835">CVE-2009-0835</a></td></tr>
<tr><td><span style="color: #ff7400;">MEDIUM</span></td><td>Non-sign extension of syscall arguments</td><td>s390</td><td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0029">CVE-2009-0029</a></td></tr>
<tr style="font-weight: bold;"><td><span style="color: #ff7400;">MEDIUM</span></td><td>EFLAGS leak on context switch</td><td>amd64/i386</td><td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5755">CVE-2006-5755</a></td></tr>
<tr><td><span style="color: #ff7400;">MEDIUM</span></td><td>Nested faults</td><td>amd64</td><td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1767">CVE-2005-1767</a></td></tr>
<tr><td><span style="color: #ff7400;">MEDIUM</span></td><td>Not handling properly certain privileged instructions</td><td>s390</td><td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0887">CVE-2004-0887</a></td></tr>
<tr><td><span style="color: #73880a;">LOW</span></td><td>Fix register leak in 32 bits syscall audititing</td><td>amd64</td><td><a href="http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=81766741fe1eee3884219e8daaf03f466f2ed52f">81766741f</a></td></tr>
<tr><td><span style="color: #73880a;">LOW</span></td><td>64-bit kernel register leak to 32-bit processes</td><td>amd64</td><td><a href="http://git.kernel.org/?p=linux/kernel/git/x86/linux-2.6-tip.git;a=commitdiff;h=24e35800cdc4350fc34e2bed37b608a9e13ab3b6">24e35800c</a></td></tr>
<tr><td><span style="color: #73880a;">LOW</span></td><td>Register leak</td><td>amd64</td><td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2910">CVE-2009-2910</a></td></tr>
<tr><td><span style="color: #73880a;">LOW</span></td><td>DoS by using malformed LDT</td><td>amd64</td><td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3247">CVE-2008-3247</a></td></tr>
<tr><td><span style="color: #73880a;">LOW</span></td><td>DoS on floating point exceptions</td><td>powerpc HTX</td><td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-3107">CVE-2007-3107</a></td></tr>
<tr><td><span style="color: #73880a;">LOW</span></td><td>DoS on 32-bit compatibility mode</td><td>amd64</td><td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1765">CVE-2005-1765</a></td></tr>
</tbody>
</table>
<br />
In other words, if you are running a pure 32 bits environment, our
initial intuition was almost good with two bugs so far (in 2004 and
2006).&nbsp;However, on AMD64, I wouldn't bet.<br />
<br />
<b>Disclaimer</b>: Off course, theses numbers are meaningless because of the
<a href="http://lwn.net/Articles/400141/">non-disclosure policy of the kernel's developpers</a>.</div>
