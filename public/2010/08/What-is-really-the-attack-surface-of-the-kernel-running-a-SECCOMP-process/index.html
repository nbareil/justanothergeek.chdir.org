<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>What is really the attack surface of the kernel running a SECCOMP process? - Just Another Geek</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="What is really the attack surface of the kernel running a SECCOMP process?" />
<meta property="og:description" content="Were our SECCOMP expectations right?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://justanothergeek.chdir.org/2010/08/What-is-really-the-attack-surface-of-the-kernel-running-a-SECCOMP-process/" /><meta property="article:published_time" content="2010-08-25T14:09:00&#43;00:00"/>
<meta property="article:modified_time" content="2010-08-25T14:09:00&#43;00:00"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="What is really the attack surface of the kernel running a SECCOMP process?"/>
<meta name="twitter:description" content="Were our SECCOMP expectations right?"/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://justanothergeek.chdir.org/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://justanothergeek.chdir.org/css/main.css" />

	
		<script src="https://justanothergeek.chdir.org/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://justanothergeek.chdir.org/">Just Another Geek</a></h1>
	<div class="site-description"><nav class="nav social">
			<ul class="flat"></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">25</span>
							<span class="rest">Aug 2010</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">What is really the attack surface of the kernel running a SECCOMP process?</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>In a previous post, <a href="http://justanothergeek.chdir.org/2010/03/seccomp-as-sandboxing-solution/">I said the attack surface of the kernel for processes running SECCOMP was really
low</a>.
To confirm this assumption, each <a href="http://secunia.com/advisories/product/2719/">vulnerability affecting the 2.6 kernel</a> was reviewed.<br />
<br />
Only those triggerable from a SECCOMPed process were kept. On 440
vulnerabilities, 13 were qualified:<br />
<br />
  Impact                                        Description                                             Architecture   Reference</p>

<hr />

<p><span style="color: #ff1a00;">HIGH</span>     infinite loop triggering signal handler                 <strong>i386</strong>       <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0554">CVE-2004-0554</a>
  <span style="color: #ff7400;">MEDIUM</span>   <code>audit_syscall_entry</code> bypass                            amd64          <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0834">CVE-2009-0834</a>
  <span style="color: #ff7400;">MEDIUM</span>   <code>SECCOMP</code> bypass                                        amd64          <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0835">CVE-2009-0835</a>
  <span style="color: #ff7400;">MEDIUM</span>   Non-sign extension of syscall arguments                 s390           <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0029">CVE-2009-0029</a>
  <span style="color: #ff7400;">MEDIUM</span>   EFLAGS leak on context switch                           amd64/i386     <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5755">CVE-2006-5755</a>
  <span style="color: #ff7400;">MEDIUM</span>   Nested faults                                           amd64          <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1767">CVE-2005-1767</a>
  <span style="color: #ff7400;">MEDIUM</span>   Not handling properly certain privileged instructions   s390           <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0887">CVE-2004-0887</a>
  <span style="color: #73880a;">LOW</span>      Fix register leak in 32 bits syscall audititing         amd64          <a href="http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=81766741fe1eee3884219e8daaf03f466f2ed52f">81766741f</a>
  <span style="color: #73880a;">LOW</span>      64-bit kernel register leak to 32-bit processes         amd64          <a href="http://git.kernel.org/?p=linux/kernel/git/x86/linux-2.6-tip.git;a=commitdiff;h=24e35800cdc4350fc34e2bed37b608a9e13ab3b6">24e35800c</a>
  <span style="color: #73880a;">LOW</span>      Register leak                                           amd64          <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2910">CVE-2009-2910</a>
  <span style="color: #73880a;">LOW</span>      DoS by using malformed LDT                              amd64          <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3247">CVE-2008-3247</a>
  <span style="color: #73880a;">LOW</span>      DoS on floating point exceptions                        powerpc HTX    <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-3107">CVE-2007-3107</a>
  <span style="color: #73880a;">LOW</span>      DoS on 32-bit compatibility mode                        amd64          <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1765">CVE-2005-1765</a></p>

<p><br />
In other words, if you are running a pure 32 bits environment, our
initial intuition was almost good with two bugs so far (in 2004 and
2006).Â However, on AMD64, I wouldn&rsquo;t bet.<br />
<br />
<strong>Disclaimer</strong>: Off course, theses numbers are meaningless because of
the <a href="http://lwn.net/Articles/400141/">non-disclosure policy of the kernel&rsquo;s developpers</a>.</p>

			</div>

			<div class="tags">
				
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-13174242-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>
</html>
